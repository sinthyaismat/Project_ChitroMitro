function drop_down(e){let t=e.target.parentElement.querySelector(".dropdown-menu");setTimeout(()=>{t.style.display="block";let e=(width=t.offsetWidth)-t.parentElement.querySelector("button").offsetWidth;t.style.left="-"+e+"px",document.addEventListener("keydown",e=>{"Escape"===e.key&&(t.style.display="none")})},100)}function remove_drop_down(e){setTimeout(()=>{e.target.parentElement.querySelector(".dropdown-menu").style.display="none"},250)}function createpost(){let e=document.querySelector(".popup");e.style.display="block",e.querySelector(".large-popup").style.display="block",document.querySelector(".body").setAttribute("aria-hidden","true"),document.querySelector("body").style.overflow="hidden",document.querySelector("#insert-img").onchange=previewFile,e.querySelector(".large-popup").querySelector("form").setAttribute("onsubmit",""),e.querySelector(".large-popup").querySelector("#post-text").addEventListener("input",t=>{t.target.value.trim().length>0?e.querySelector(".submit-btn").disabled=!1:t.target.parentElement.querySelector("#img-div").style.backgroundImage?e.querySelector(".submit-btn").disabled=!1:e.querySelector(".submit-btn").disabled=!0})}function confirm_delete(e){let t=document.querySelector(".popup");t.style.display="block";let r=t.querySelector(".small-popup");r.style.display="block",document.querySelector(".body").setAttribute("aria-hidden","true"),document.querySelector("body").style.overflow="hidden",r.querySelector("#delete_post_btn").setAttribute("onclick",`delete_post(${e})`)}function delete_post(e){remove_popup(),setTimeout(()=>{let t=0;document.querySelectorAll(".post").forEach(r=>{r.dataset.post_id==e&&(t=r)}),t.style.animationPlayState="running",t.addEventListener("animationend",()=>{t.remove()}),fetch("/n/post/"+parseInt(e)+"/delete",{method:"PUT"})},200)}function edit_post(e){let t=e.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement,r=document.querySelector(".large-popup");new Promise((e,o)=>{let l=t.querySelector(".post-content").innerText,n=t.querySelector(".post-image").style.backgroundImage;r.querySelector("#post-text").value=l,n?(r.querySelector("#img-div").style.backgroundImage=n,document.querySelector("#del-img").addEventListener("click",del_image),r.querySelector("#img-div").style.display="block"):r.querySelector("#img-div").style.backgroundImage="",e(r)}).then(()=>{createpost(),r.querySelector("form").setAttribute("onsubmit",`return edit_post_submit(${t.dataset.post_id})`),r.querySelector(".submit-btn").disabled=!1})}function edit_post_submit(e){let t=document.querySelector(".large-popup"),r=t.querySelector("#post-text").value,o=t.querySelector("#insert-img"),l=t.querySelector("#img-change"),n=new FormData;return n.append("text",r),n.append("picture",o.files[0]),n.append("img_change",l.value),n.append("id",e),fetch("/n/post/"+parseInt(e)+"/edit",{method:"POST",body:n}).then(e=>e.json()).then(t=>{if(t.success)return document.querySelectorAll(".post").forEach(r=>{parseInt(r.dataset.post_id)===parseInt(e)&&(t.text?r.querySelector(".post-content").innerText=t.text:r.querySelector(".post-content").innerText="",t.picture?(r.querySelector(".post-image").style.backgroundImage=`url(${t.picture})`,r.querySelector(".post-image").style.display="block"):(r.querySelector(".post-image").style.backgroundImage="",r.querySelector(".post-image").style.display="none"))}),!1;console.log("There was an error while editing the post.")}),remove_popup(),!1}function remove_popup(){document.querySelector(".popup").style.display="none",document.querySelector(".body").style.marginRight="0px",document.querySelector(".body").setAttribute("aria-hidden","false"),document.querySelector("body").style.overflow="auto";let e=document.querySelector(".small-popup"),t=document.querySelector(".large-popup"),r=document.querySelector(".login-popup");e.style.display="none",t.style.display="none",r.style.display="none",t.querySelector("#post-text").value="",t.querySelector("#insert-img").value="",t.querySelector("#img-div").style.backgroundImage="",t.querySelector("#img-change").value="false",t.querySelector("#img-div").style.display="none"}function login_popup(e){let t=document.querySelector(".popup");t.style.display="block",t.querySelector(".login-popup").style.display="block",document.querySelector(".body").setAttribute("aria-hidden","true"),document.querySelector("body").style.overflow="hidden","like"===e?(document.querySelector(".icon-div").innerHTML=`
        <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-heart-fill" fill="#e0245e" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
        </svg>`,document.querySelector(".main_text-div").querySelector("h2").innerText="Like a post to share the love"):"comment"===e?(document.querySelector(".icon-div").innerHTML=`
        <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-chat-fill" fill="#1da1f2" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6-.097 1.016-.417 2.13-.771 2.966-.079.186.074.394.273.362 2.256-.37 3.597-.938 4.18-1.234A9.06 9.06 0 0 0 8 15z"/>
        </svg>`,document.querySelector(".main_text-div").querySelector("h2").innerText="Comment to join the conversation"):"save"===e?(document.querySelector(".icon-div").innerHTML=`
        <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-bookmark-fill" fill="#17bf63" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M3 3a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v12l-5-3-5 3V3z"/>
        </svg>`,document.querySelector(".main_text-div").querySelector("h2").innerText="Save a post to reference later"):"follow"===e&&(document.querySelector(".icon-div").innerHTML=`
        <svg width="2.5em" height="2.5em" viewBox="0 0 24 24" fill="#17bf63" class="r-1re7ezh r-4qtqp9 r-yyyyoo r-1q142lx r-1xvli5t r-19einr3 r-dnmrzs r-bnwqim r-1plcrui r-lrvibr">
            <g><path d="M23.152 3.483h-2.675V.81c0-.415-.336-.75-.75-.75s-.75.335-.75.75v2.674H16.3c-.413 0-.75.336-.75.75s.337.75.75.75h2.677V7.66c0 .413.336.75.75.75s.75-.337.75-.75V4.982h2.675c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zM8.417 11.816c1.355 0 2.872-.15 3.84-1.256.813-.93 1.077-2.367.806-4.392-.38-2.826-2.116-4.513-4.646-4.513S4.15 3.342 3.77 6.168c-.27 2.025-.007 3.462.807 4.393.968 1.108 2.485 1.257 3.84 1.257zm-3.16-5.448c.16-1.2.786-3.212 3.16-3.212 2.373 0 2.998 2.013 3.16 3.212.207 1.55.056 2.627-.45 3.205-.455.52-1.266.743-2.71.743s-2.256-.223-2.71-.743c-.507-.578-.658-1.656-.45-3.205zm11.44 12.867c-.88-3.525-4.283-5.988-8.28-5.988-3.998 0-7.403 2.463-8.28 5.988-.172.693-.03 1.4.395 1.94.408.522 1.04.822 1.733.822H14.57c.69 0 1.323-.3 1.73-.82.425-.54.568-1.247.396-1.942zm-1.577 1.018c-.126.16-.316.245-.55.245H2.264c-.235 0-.426-.085-.552-.246-.137-.174-.18-.412-.12-.654.71-2.855 3.517-4.85 6.824-4.85s6.113 1.994 6.824 4.85c.06.24.017.48-.12.655z"></path></g>
        </svg>`,document.querySelector(".main_text-div").querySelector("h2").innerText="Follow people that inspires you")}function previewFile(){document.querySelector("#img-div").style.display="block",document.querySelector("#spinner").style.display="block",document.querySelector("#del-img").style.display="none",document.querySelector("#del-img").addEventListener("click",del_image);var e=document.querySelector("#img-div"),t=document.querySelector("input[type=file]").files[0],r=new FileReader;(r.onloadend=function(){e.style.backgroundImage=`url(${r.result})`,document.querySelector(".large-popup").querySelector("#img-change").value="true"},t)?(document.querySelector(".form-action-btns").querySelector("input[type=submit]").disabled=!1,new Promise(function(e,o){setTimeout(()=>{e(r.readAsDataURL(t))},500)}).then(function(){document.querySelector("#spinner").style.display="none",document.querySelector("#del-img").style.display="block"}).catch(function(){console.log("Some error has occured")})):(document.querySelector("#spinner").style.display="none",document.querySelector("#del-img").style.display="block")}function del_image(){document.querySelector("input[type=file]").value="",document.querySelector("#img-div").style.backgroundImage="",document.querySelector("#img-div").style.display="none",document.querySelector(".large-popup").querySelector("#img-change").value="true",document.querySelector(".large-popup").querySelector("#post-text").value.trim().length<=0&&(document.querySelector(".large-popup").querySelector(".form-action-btns").querySelector("input[type=submit]").disabled=!0)}function like_post(e){if("False"===document.querySelector("#user_is_authenticated").value)return login_popup("like"),!1;fetch("/n/post/"+parseInt(e.dataset.post_id)+"/like",{method:"PUT"}).then(()=>{let t=e.querySelector(".likes_count"),r=t.innerHTML;r++,t.innerHTML=r,e.querySelector(".svg-span").innerHTML=`
            <svg width="1.1em" height="1.1em" viewBox="0 -1 16 16" class="bi bi-heart-fill" fill="#e0245e" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
            </svg>`,e.setAttribute("onclick","unlike_post(this)")})}function unlike_post(e){fetch("/n/post/"+parseInt(e.dataset.post_id)+"/unlike",{method:"PUT"}).then(()=>{let t=e.querySelector(".likes_count"),r=t.innerHTML;r--,t.innerHTML=r,e.querySelector(".svg-span").innerHTML=`
            <svg width="1.1em" height="1.1em" viewBox="0 -1 16 16" class="bi bi-heart" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
            </svg>`,e.setAttribute("onclick","like_post(this)")})}function save_post(e){if("False"===document.querySelector("#user_is_authenticated").value)return login_popup("save"),!1;fetch("/n/post/"+parseInt(e.dataset.post_id)+"/save",{method:"PUT"}).then(()=>{e.querySelector(".svg-span").innerHTML=`
            <svg width="1.1em" height="1.1em" viewBox="0.5 0 15 15" class="bi bi-bookmark-fill" fill="#17bf63" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M3 3a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v12l-5-3-5 3V3z"/>
            </svg>`,e.setAttribute("onclick","unsave_post(this)")})}function unsave_post(e){fetch("/n/post/"+parseInt(e.dataset.post_id)+"/unsave",{method:"PUT"}).then(()=>{e.querySelector(".svg-span").innerHTML=`
        <svg width="1.1em" height="1.1em" viewBox="0.5 0 15 15" class="bi bi-bookmark" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M8 12l5 3V3a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12l5-3zm-4 1.234l4-2.4 4 2.4V3a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v10.234z"/>
        </svg>`,e.setAttribute("onclick","save_post(this)")})}function follow_user(e,t,r){if("False"===document.querySelector("#user_is_authenticated").value)return login_popup("follow"),!1;fetch("/"+t+"/follow",{method:"PUT"}).then(()=>{"suggestion"===r?e.parentElement.innerHTML=`<button class="btn btn-success" type="button" onclick="unfollow_user(this,'${t}','suggestion')">Following</button>`:"edit_page"===r&&(e.parentElement.innerHTML=`<button class="btn btn-success float-right" onclick="unfollow_user(this,'${t}','edit_page')" id="following-btn">Following</button>`),"profile"===document.querySelector(".body").dataset.page&&document.querySelector(".profile-view").dataset.user===t&&document.querySelector("#follower__count").innerHTML++,"profile"===document.querySelector(".body").dataset.page&&document.querySelector(".profile-view").dataset.user===document.querySelector("#user_is_authenticated").dataset.username&&document.querySelector("#following__count").innerHTML++})}function unfollow_user(e,t,r){if("False"===document.querySelector("#user_is_authenticated").value)return login_popup("follow"),!1;fetch("/"+t+"/unfollow",{method:"PUT"}).then(()=>{"suggestion"===r?e.parentElement.innerHTML=`<button class="btn btn-outline-success" type="button" onclick="follow_user(this,'${t}','suggestion')">Follow</button>`:"edit_page"===r&&(e.parentElement.innerHTML=`<button class="btn btn-outline-success float-right" onclick="follow_user(this,'${t}','edit_page')" id="follow-btn">Follow</button>`),"profile"===document.querySelector(".body").dataset.page&&document.querySelector(".profile-view").dataset.user===t&&document.querySelector("#follower__count").innerHTML--,"profile"===document.querySelector(".body").dataset.page&&document.querySelector(".profile-view").dataset.user===document.querySelector("#user_is_authenticated").dataset.username&&document.querySelector("#following__count").innerHTML--})}function show_comment(e){if("False"===document.querySelector("#user_is_authenticated").value){login_popup("comment");return}let t=e.parentElement.parentElement.parentElement.parentElement,r=t.dataset.post_id,o=t.querySelector(".comment-div"),l=o.querySelector(".comment-div-data").querySelector(".comment-comments");if("block"===o.style.display){o.querySelector("input").focus();return}o.querySelector("#spinner").style.display="block",o.style.display="block",fetch("/n/post/"+parseInt(r)+"/comments").then(e=>e.json()).then(e=>{e.forEach(e=>{display_comment(e,l)})}).then(()=>{setTimeout(()=>{o.querySelector(".spinner-div").style.display="none",o.querySelector(".comment-div-data").style.display="block",o.style.overflow="auto"},500)})}function write_comment(e){let t=e.parentElement.parentElement.parentElement.parentElement.parentElement.dataset.post_id,r=e.querySelector(".comment-input").value,o=e.parentElement.parentElement.parentElement.parentElement.querySelector(".comment-comments"),l=o.parentElement.parentElement.parentElement.querySelector(".cmt-count");return!(r.trim().length<=0)&&(fetch("/n/post/"+parseInt(t)+"/write_comment",{method:"POST",body:JSON.stringify({comment_text:r})}).then(e=>e.json()).then(t=>(console.log(t),e.querySelector("input").value="",l.innerHTML++,display_comment(t[0],o,!0),!1)),!1)}function display_comment(e,t,r=!1){document.querySelector("#user_is_authenticated").dataset.username;let o=document.createElement("div");o.className="eachrow",o.setAttribute("data-id",e.id),o.innerHTML=`
        <div>
            <a href='/${e.commenter.username}'>
                <div class="small-profilepic" style="background-image: url(${e.commenter.profile_pic})"></div>
            </a>
        </div>
        <div style="flex: 1;">
            <div class="comment-text-div">
                <div class="comment-user">
                    <a href="/${e.commenter.username}">
                        ${e.commenter.first_name} ${e.commenter.last_name}
                    </a>
                </div>
                ${e.body}
            </div>
        </div>`,r?(o.classList.add("godown"),t.innerHTML,t.prepend(o)):t.append(o)}function goto_register(){window.location.href="/n/register"}function goto_login(){window.location.href="/n/login"}document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".body").dataset.page;document.querySelector("#"+e).classList.add("active")});
document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".inp").forEach(input=>{input.addEventListener('input',()=>{if((document.querySelector('.usrnm').value.length===0)||(document.querySelector('.pswd').value.length===0)){document.querySelector('input[type="submit"]').disabled=!0}else{document.querySelector('input[type="submit"]').disabled=!1}})})})
document.addEventListener("DOMContentLoaded",()=>{let e=[!1,!1,!1,!1,!1,!1];document.querySelectorAll(".inp").forEach(t=>{t.addEventListener("input",()=>{t.classList.contains("usrname")&&(0!==t.value.trim().length?e[0]=!0:e[0]=!1),t.classList.contains("fname")&&(0!==t.value.trim().length?e[1]=!0:e[1]=!1),t.classList.contains("lname")&&(0!==t.value.trim().length?e[2]=!0:e[2]=!1),t.classList.contains("pswd")&&(document.querySelector(".cpswd").value="",document.querySelector(".cpswd").parentElement.querySelector("span").innerText="",e[4]=!1,0!==t.value.trim().length?e[3]=!0:e[3]=!1),t.classList.contains("cpswd")&&(0!==t.value.trim().length?t.value!==document.querySelector(".pswd").value?(t.parentElement.querySelector("span").innerText="Password must match",e[4]=!1):(t.parentElement.querySelector("span").innerText="",e[4]=!0):e[4]=!1),t.classList.contains("email")&&(0!==t.value.trim().length?e[5]=!0:e[5]=!1);let l;for(l=0;l<6&&e[l];l++);6===l?document.querySelector('input[type="submit"]').disabled=!1:document.querySelector('input[type="submit"]').disabled=!0})}),document.querySelectorAll(".custom-file-input").forEach(e=>{e.addEventListener("change",e=>{e.target.files[0]?e.target.parentElement.querySelector(".custom-file-label").innerText=e.target.files[0].name:"profile"==e.target.id?e.target.parentElement.querySelector(".custom-file-label").innerHTML='<span style="color: #6c757d;">Choose profile picture<span>':"cover"==e.target.id&&(e.target.parentElement.querySelector(".custom-file-label").innerHTML='<span style="color: #6c757d;">Choose cover picture<span>')})})});
